generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id         Int         @id @default(autoincrement())
  email      String      @unique
  name       String?
  password   String
  role       Role        @default(Employee)
  quotations Quotation[]
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
}

model Quotation {
  id               String   @id @default(uuid())
  quotationNo      String   @unique
  travelDate       DateTime
  groupSize        Int
  mealPlan         String?
  place            String?
  vehicleUsed      String?
  localVehicleUsed String?
  flightCost       Float?
  flightImageUrl   String?
  landCostPerHead  Float?
  totalPerHead     Float?
  totalGroupCost   Float?
  clientPhone      String?
  clientName       String?
  clientEmail      String?
  clientAddress    String?

  notes       String?
  totalNights Int     @default(0)

  accommodation Accommodation[]
  itinerary     ItineraryItem[]
  inclusions    Inclusion[]
  exclusions    Exclusion[]

  createdBy   User            @relation(fields: [createdById], references: [id])
  createdById Int
  status      QuotationStatus @default(DRAFT)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
}

model Accommodation {
  id          Int       @id @default(autoincrement())
  location    String
  hotelName   String
  nights      Int
  quotation   Quotation @relation(fields: [quotationId], references: [id])
  quotationId String
}

model ItineraryItem {
  id          Int       @id @default(autoincrement())
  dayTitle    String
  description String
  quotation   Quotation @relation(fields: [quotationId], references: [id])
  quotationId String
}

model Inclusion {
  id          Int       @id @default(autoincrement())
  item        String
  quotation   Quotation @relation(fields: [quotationId], references: [id])
  quotationId String
}

model Exclusion {
  id          Int       @id @default(autoincrement())
  item        String
  quotation   Quotation @relation(fields: [quotationId], references: [id])
  quotationId String
}

enum Role {
  Employee
  Admin
}

enum QuotationStatus {
  DRAFT
  SENT
  ACCEPTED
  REJECTED
  CANCELLED
}

enum ServiceType {
  HOTEL
  FLIGHT
  TOUR
  INSURANCE
  OTHER
}
