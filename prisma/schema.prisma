generator client {
  provider = "prisma-client-js" 
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id         Int      @id @default(autoincrement())
  email      String      @unique
  name       String?
  password   String
  role       Role        @default(Employee)
  quotations Quotation[]
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
}

model Quotation {
  id            String          @id @default(uuid())
  quotationNo   String          @unique
  clientName    String
  clientEmail   String?
  clientAddress String?
  // ── Travel Details ───────────────────────────────────────────────
  departureCity    String
  destinationCity  String
  departureDate    DateTime
  returnDate       DateTime?         
  travelersCount   Int

  // ── Pricing ───────────────────────────────────────────────────────
  subtotal         Float
  tax              Float
  discount         Float?
  total            Float

  status           QuotationStatus  @default(DRAFT)

  // ── Relations ────────────────────────────────────────────────────
  createdBy        User             @relation(fields: [createdById], references: [id])
  createdById      Int
  itineraryItems   ItineraryItem[]  
  services         ServiceItem[]    

  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt
}

model ItineraryItem {
  id            Int       @id @default(autoincrement())
  day           Int        
  description   String
  date          DateTime
  cost          Float

  quotation     Quotation @relation(fields: [quotationId], references: [id])
  quotationId   String
}

model ServiceItem {
  id            Int       @id @default(autoincrement())
  type          ServiceType
  details       String
  cost          Float

  quotation     Quotation @relation(fields: [quotationId], references: [id])
  quotationId   String
}

enum Role {
  Employee
  Admin
}

enum QuotationStatus {
  DRAFT
  SENT
  ACCEPTED
  REJECTED
  CANCELLED
}

enum ServiceType {
  HOTEL
  FLIGHT
  TOUR
  INSURANCE
  OTHER
}